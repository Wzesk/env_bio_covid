Your config specifies 'skip_travel_history_adjustment=True'. This is now always the case, and thus this parameter can be removed.
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 8
Rules claiming more threads will be scaled down.
Conda environments: ignored
Job stats:
job                         count    min threads    max threads
------------------------  -------  -------------  -------------
add_branch_labels               1              1              1
adjust_metadata_regions         1              1              1
align                           1              8              8
all                             1              1              1
ancestral                       1              1              1
build_align                     1              8              8
calculate_epiweeks              1              1              1
clades                          1              1              1
colors                          1              1              1
combine_samples                 1              1              1
diagnostic                      1              1              1
distances                       1              1              1
emerging_lineages               1              1              1
export                          1              1              1
filter                          1              1              1
finalize                        1              1              1
include_hcov19_prefix           1              1              1
index_sequences                 1              1              1
logistic_growth                 1              1              1
mask                            1              1              1
mutational_fitness              1              1              1
recency                         1              1              1
refine                          1              1              1
rename_emerging_lineages        1              1              1
sanitize_metadata               1              1              1
subsample                       1              1              1
tip_frequencies                 1              1              1
traits                          1              1              1
translate                       1              1              1
tree                            1              8              8
total                          30              1              8

Select jobs to execute...

[Fri Nov 26 23:47:02 2021]
Job 11: 
        Aligning sequences to defaults/reference_seq.fasta
            - gaps relative to reference are considered real
        


        python3 scripts/sanitize_sequences.py             --sequences data/b1526.sequences.fasta             --strip-prefixes hCoV-19/ SARS-CoV-2/             --output /dev/stdout 2> logs/sanitize_sequences_b_1_526.txt             | nextalign             --jobs=8             --reference defaults/reference_seq.fasta             --genemap defaults/annotation.gff             --genes ORF1a,ORF1b,S,ORF3a,M,N             --sequences /dev/stdin             --output-dir results/translations             --output-basename seqs_b_1_526             --output-fasta results/aligned_b_1_526.fasta             --output-insertions results/insertions_b_1_526.tsv > logs/align_b_1_526.txt 2>&1;
        xz -2 results/aligned_b_1_526.fasta;
        xz -2 results/translations/seqs_b_1_526*.fasta
        
[Fri Nov 26 23:47:51 2021]
Finished job 11.
1 of 30 steps (3%) done
Select jobs to execute...

[Fri Nov 26 23:47:51 2021]
rule sanitize_metadata:
    input: data/b1526.metadata.tsv
    output: results/sanitized_metadata_b_1_526.tsv.xz
    log: logs/sanitize_metadata_b_1_526.txt
    jobid: 12
    benchmark: benchmarks/sanitize_metadata_b_1_526.txt
    wildcards: origin=b_1_526
    resources: tmpdir=/tmp, mem_mb=2000


        python3 scripts/sanitize_metadata.py             --metadata data/b1526.metadata.tsv             --metadata-id-columns strain name 'Virus name'             --database-id-columns 'Accession ID' gisaid_epi_isl genbank_accession             --parse-location-field Location             --rename-fields 'Virus name=strain' Type=type 'Accession ID=gisaid_epi_isl' 'Collection date=date' 'Additional location information=additional_location_information' 'Sequence length=length' Host=host 'Patient age=patient_age' Gender=sex Clade=GISAID_clade 'Pango lineage=pango_lineage' pangolin_lineage=pango_lineage Lineage=pango_lineage 'Pangolin version=pangolin_version' Variant=variant 'AA Substitutions=aa_substitutions' aaSubstitutions=aa_substitutions 'Submission date=date_submitted' 'Is reference?=is_reference' 'Is complete?=is_complete' 'Is high coverage?=is_high_coverage' 'Is low coverage?=is_low_coverage' N-Content=n_content GC-Content=gc_content             --strip-prefixes hCoV-19/ SARS-CoV-2/                          --output results/sanitized_metadata_b_1_526.tsv.xz 2>&1 | tee logs/sanitize_metadata_b_1_526.txt
        
[Fri Nov 26 23:48:12 2021]
Finished job 12.
2 of 30 steps (7%) done
Select jobs to execute...

[Fri Nov 26 23:48:12 2021]
Job 13: Scanning metadata results/sanitized_metadata_b_1_526.tsv.xz for problematic sequences. Removing sequences with >20 deviation from the clock and with more than 1.


        python3 scripts/diagnostic.py             --metadata results/sanitized_metadata_b_1_526.tsv.xz             --clock-filter 20             --rare-mutations 100             --clock-plus-rare 100             --snp-clusters 1             --output-exclusion-list results/to-exclude_b_1_526.txt 2>&1 | tee logs/diagnostics_b_1_526.txt
        
[Fri Nov 26 23:48:25 2021]
Finished job 13.
3 of 30 steps (10%) done
Select jobs to execute...

[Fri Nov 26 23:48:25 2021]
Job 10: 
        Filtering alignment results/aligned_b_1_526.fasta.xz -> results/filtered_b_1_526.fasta.xz
          - excluding strains in defaults/exclude.txt results/to-exclude_b_1_526.txt
          - including strains in b1526_profiles/include.txt
          - min length: 27000
        


        augur filter             --sequences results/aligned_b_1_526.fasta.xz             --metadata results/sanitized_metadata_b_1_526.tsv.xz             --include b1526_profiles/include.txt             --max-date 2021-11-27             --min-date 2019.74             --exclude-ambiguous-dates-by any             --exclude defaults/exclude.txt results/to-exclude_b_1_526.txt             --exclude-where division='USA'            --min-length 27000             --output results/filtered_b_1_526.fasta 2>&1 | tee logs/filtered_b_1_526.txt;
        xz -2 results/filtered_b_1_526.fasta
        
[Fri Nov 26 23:48:47 2021]
Finished job 10.
4 of 30 steps (13%) done
Select jobs to execute...

[Fri Nov 26 23:48:47 2021]
Job 14: 
        Index sequence composition for faster filtering.
        


        augur index             --sequences results/filtered_b_1_526.fasta.xz             --output results/combined_sequence_index.tsv.xz 2>&1 | tee logs/index_sequences.txt
        
[Fri Nov 26 23:49:08 2021]
Finished job 14.
5 of 30 steps (17%) done
Select jobs to execute...

[Fri Nov 26 23:49:08 2021]
Job 15: 
        Subsample all sequences by 'lineage-focus' scheme for build 'b_lineage' with the following parameters:

         - group by: --group-by year month
         - sequences per group: 
         - subsample max sequences: --subsample-max-sequences 1000
         - min-date: 
         - max-date: 
         - 
         - exclude: 
         - include: 
         - query: --query "(pango_lineage == 'B.1.526' | pango_lineage == 'B.1.526.1' | pango_lineage == 'B.1.526.2')"
         - priority: 
        


        augur filter             --sequences results/filtered_b_1_526.fasta.xz             --metadata results/sanitized_metadata_b_1_526.tsv.xz             --sequence-index results/combined_sequence_index.tsv.xz             --include b1526_profiles/include.txt             --exclude defaults/exclude.txt                                                                 --query "(pango_lineage == 'B.1.526' | pango_lineage == 'B.1.526.1' | pango_lineage == 'B.1.526.2')"                                       --group-by year month                          --subsample-max-sequences 1000                          --output results/b_lineage/sample-lineage-focus.fasta             --output-strains results/b_lineage/sample-lineage-focus.txt 2>&1 | tee logs/subsample_b_lineage_lineage-focus.txt
        
[Fri Nov 26 23:49:29 2021]
Finished job 15.
6 of 30 steps (20%) done
Select jobs to execute...

[Fri Nov 26 23:49:29 2021]
Job 9: 
        Combine and deduplicate FASTAs
        


        augur filter             --sequences results/filtered_b_1_526.fasta.xz             --sequence-index results/combined_sequence_index.tsv.xz             --metadata results/sanitized_metadata_b_1_526.tsv.xz             --exclude-all             --include results/b_lineage/sample-lineage-focus.txt             --output-sequences results/b_lineage/b_lineage_subsampled_sequences.fasta.xz             --output-metadata results/b_lineage/b_lineage_subsampled_metadata.tsv.xz 2>&1 | tee logs/subsample_regions_b_lineage.txt
        
[Fri Nov 26 23:49:54 2021]
Finished job 9.
7 of 30 steps (23%) done
Select jobs to execute...

[Fri Nov 26 23:49:54 2021]
Job 8: 
        Aligning sequences to defaults/reference_seq.fasta
            - gaps relative to reference are considered real
        


        xz -c -d results/b_lineage/b_lineage_subsampled_sequences.fasta.xz | nextalign             --jobs=8             --reference defaults/reference_seq.fasta             --genemap defaults/annotation.gff             --genes ORF1a,ORF1b,S,ORF3a,M,N             --sequences /dev/stdin             --output-dir results/b_lineage/translations             --output-basename aligned             --output-fasta results/b_lineage/aligned.fasta             --output-insertions results/b_lineage/insertions.tsv > logs/align_b_lineage.txt 2>&1
        
[Fri Nov 26 23:49:58 2021]
Finished job 8.
8 of 30 steps (27%) done
Select jobs to execute...

[Fri Nov 26 23:49:58 2021]
Job 16: 
        Adjusting metadata for build 'b_lineage'
        


        python3 scripts/adjust_regional_meta.py             --region global             --metadata results/b_lineage/b_lineage_subsampled_metadata.tsv.xz             --output results/b_lineage/metadata_adjusted.tsv.xz 2>&1 | tee logs/adjust_metadata_regions_b_lineage.txt
        

[Fri Nov 26 23:49:58 2021]
Job 7: 
        Mask bases in alignment results/b_lineage/aligned.fasta
          - masking 100 from beginning
          - masking 50 from end
          - masking other sites: 21987 21846
        


        python3 scripts/mask-alignment.py             --alignment results/b_lineage/aligned.fasta             --mask-from-beginning 100             --mask-from-end 50             --mask-sites 21987 21846             --mask-terminal-gaps             --output results/b_lineage/masked.fasta 2> logs/mask_b_lineage.txt
        
[Fri Nov 26 23:50:07 2021]
Finished job 16.
9 of 30 steps (30%) done
Select jobs to execute...

[Fri Nov 26 23:50:07 2021]
rule calculate_epiweeks:
    input: results/b_lineage/metadata_adjusted.tsv.xz
    output: results/b_lineage/epiweeks.json
    log: logs/calculate_epiweeks_b_lineage.txt
    jobid: 29
    benchmark: benchmarks/calculate_epiweeks_b_lineage.txt
    wildcards: build_name=b_lineage
    resources: tmpdir=/tmp


        python3 scripts/calculate_epiweek.py             --metadata results/b_lineage/metadata_adjusted.tsv.xz             --output-node-data results/b_lineage/epiweeks.json 2>&1 | tee logs/calculate_epiweeks_b_lineage.txt
        

[Fri Nov 26 23:50:07 2021]
Job 30: Constructing colors file


        python3 scripts/assign-colors.py             --ordering defaults/color_ordering.tsv             --color-schemes defaults/color_schemes.tsv             --output results/b_lineage/colors.tsv             --metadata results/b_lineage/metadata_adjusted.tsv.xz 2>&1 | tee logs/colors_b_lineage.txt
        

[Fri Nov 26 23:50:07 2021]
Job 23: Use metadata on submission date to construct submission recency field


        python3 scripts/construct-recency-from-submission-date.py             --metadata results/b_lineage/metadata_adjusted.tsv.xz             --output results/b_lineage/recency.json 2>&1 | tee logs/recency_b_lineage.txt
        
[Fri Nov 26 23:50:13 2021]
Finished job 30.
10 of 30 steps (33%) done
[Fri Nov 26 23:50:16 2021]
Finished job 29.
11 of 30 steps (37%) done
[Fri Nov 26 23:50:16 2021]
Finished job 23.
12 of 30 steps (40%) done
[Fri Nov 26 23:50:17 2021]
Finished job 7.
13 of 30 steps (43%) done
Select jobs to execute...

[Fri Nov 26 23:50:17 2021]
Job 6: Building tree


        augur tree             --alignment results/b_lineage/masked.fasta             --tree-builder-args '-ninit 10 -n 4'             --exclude-sites defaults/sites_ignored_for_tree_topology.txt             --output results/b_lineage/tree_raw.nwk             --nthreads 8 2>&1 | tee logs/tree_b_lineage.txt
        
[Fri Nov 26 23:51:22 2021]
Finished job 6.
14 of 30 steps (47%) done
Select jobs to execute...

[Fri Nov 26 23:51:22 2021]
Job 5: 
        Refining tree
          - estimate timetree
          - use opt coalescent timescale
          - estimate marginal node dates
        


        augur refine             --tree results/b_lineage/tree_raw.nwk             --alignment results/b_lineage/masked.fasta             --metadata results/b_lineage/metadata_adjusted.tsv.xz             --output-tree results/b_lineage/tree.nwk             --output-node-data results/b_lineage/branch_lengths.json             --root Wuhan/Hu-1/2019             --timetree                          --clock-rate 0.0008             --clock-std-dev 0.0004             --coalescent opt             --date-inference marginal             --divergence-unit mutations             --date-confidence             --no-covariance             --clock-filter-iqd 4 2>&1 | tee logs/refine_b_lineage.txt
        
[Fri Nov 26 23:51:56 2021]
Error in rule refine:
    jobid: 5
    output: results/b_lineage/tree.nwk, results/b_lineage/branch_lengths.json
    log: logs/refine_b_lineage.txt (check log file(s) for error message)
    shell:
        
        augur refine             --tree results/b_lineage/tree_raw.nwk             --alignment results/b_lineage/masked.fasta             --metadata results/b_lineage/metadata_adjusted.tsv.xz             --output-tree results/b_lineage/tree.nwk             --output-node-data results/b_lineage/branch_lengths.json             --root Wuhan/Hu-1/2019             --timetree                          --clock-rate 0.0008             --clock-std-dev 0.0004             --coalescent opt             --date-inference marginal             --divergence-unit mutations             --date-confidence             --no-covariance             --clock-filter-iqd 4 2>&1 | tee logs/refine_b_lineage.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /vortexfs1/omics/env-bio/collaboration/env_bio_covid/ncov/.snakemake/log/2021-11-26T234655.348913.snakemake.log
